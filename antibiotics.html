<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KKM Antibiotic Dosing Guide (NAG Malaysia)</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: #f0f4f8;
            margin: 0;
            padding: 20px;
            color: #333;
        }
        .container {
            max-width: 600px;
            margin: 0 auto;
            background: #fff;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        h1 {
            text-align: center;
            color: #2c3e50;
            font-size: 22px;
            margin-bottom: 20px;
        }
        .disclaimer {
            font-size: 12px;
            color: #7f8c8d;
            background: #eef2f3;
            padding: 10px;
            border-radius: 6px;
            margin-bottom: 20px;
            text-align: center;
        }
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #34495e;
        }
        select, input {
            width: 100%;
            padding: 12px;
            margin-bottom: 20px;
            border: 1px solid #bdc3c7;
            border-radius: 8px;
            box-sizing: border-box;
            font-size: 16px;
        }
        button {
            width: 100%;
            padding: 15px;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: background 0.3s;
        }
        button:hover {
            background-color: #2980b9;
        }
        #result {
            margin-top: 25px;
            display: none;
            background: #e8f6f3;
            border: 1px solid #d5dbdb;
            border-radius: 8px;
            padding: 20px;
        }
        .result-item {
            margin-bottom: 15px;
        }
        .result-label {
            font-weight: bold;
            color: #16a085;
            display: block;
            margin-bottom: 4px;
        }
        .result-value {
            font-size: 18px;
            color: #2c3e50;
        }
        .hidden {
            display: none;
        }
        .source-link {
            text-align: center;
            margin-top: 20px;
            font-size: 12px;
        }
        .source-link a {
            color: #3498db;
            text-decoration: none;
        }
    </style>
</head>
<body>

<div class="container">
    <h1>ðŸ‡²ðŸ‡¾ KKM Antibiotic Dosing Guide</h1>
    <div class="disclaimer">
        Based on National Antimicrobial Guideline (NAG) 2019/2024. <br>For healthcare professional use only. Verify with clinical judgment.
    </div>

    <label for="category">Patient Category</label>
    <select id="category" onchange="toggleWeight()">
        <option value="adult">Adult</option>
        <option value="paeds">Paediatrics (Child)</option>
    </select>

    <div id="weight-container" class="hidden">
        <label for="weight">Weight (kg)</label>
        <input type="number" id="weight" placeholder="e.g. 15" step="0.1">
    </div>

    <label for="indication">Indication</label>
    <select id="indication">
        <option value="pneumonia">Community Acquired Pneumonia (CAP)</option>
        <option value="pharyngitis">Acute Pharyngitis / Tonsillitis</option>
        <option value="otitis">Acute Otitis Media</option>
        <option value="rhinosinusitis">Acute Rhinosinusitis</option>
        <option value="uti">Urinary Tract Infection (Uncomplicated)</option>
        <option value="skin">Skin & Soft Tissue (Impetigo/Cellulitis)</option>
    </select>

    <button onclick="calculateDose()">Calculate Dose</button>

    <div id="result">
        <div class="result-item">
            <span class="result-label">Recommended Antibiotic</span>
            <span class="result-value" id="res-drug"></span>
        </div>
        <div class="result-item">
            <span class="result-label">Dose</span>
            <span class="result-value" id="res-dose"></span>
        </div>
        <div class="result-item">
            <span class="result-label">Frequency</span>
            <span class="result-value" id="res-freq"></span>
        </div>
        <div class="result-item">
            <span class="result-label">Duration</span>
            <span class="result-value" id="res-duration"></span>
        </div>
        <div class="result-item">
            <span class="result-label">Remarks</span>
            <span class="result-value" id="res-remarks" style="font-size: 14px; color: #555;"></span>
        </div>
    </div>

    <div class="source-link">
        Source: <a href="https://sites.google.com/moh.gov.my/nag" target="_blank">MOH NAG Website</a>
    </div>
</div>

<script>
    function toggleWeight() {
        const cat = document.getElementById('category').value;
        const weightDiv = document.getElementById('weight-container');
        if (cat === 'paeds') {
            weightDiv.classList.remove('hidden');
        } else {
            weightDiv.classList.add('hidden');
        }
    }

    function calculateDose() {
        const cat = document.getElementById('category').value;
        const weight = parseFloat(document.getElementById('weight').value);
        const indication = document.getElementById('indication').value;
        
        let drug = "";
        let dose = "";
        let freq = "";
        let duration = "";
        let remarks = "";

        // ERROR HANDLING
        if (cat === 'paeds' && (!weight || weight <= 0)) {
            alert("Please enter a valid weight in kg.");
            return;
        }

        // ADULT LOGIC
        if (cat === 'adult') {
            switch (indication) {
                case 'pneumonia':
                    drug = "Amoxicillin";
                    dose = "1g (1000 mg)";
                    freq = "BD (Every 12 hours)";
                    duration = "5 - 7 days";
                    remarks = "Preferred line. Alternative: Amoxicillin 500mg TDS. If comorbid: Augmentin 625mg TDS.";
                    break;
                case 'pharyngitis':
                    drug = "Phenoxymethylpenicillin (Pen V)";
                    dose = "1g (1000 mg)";
                    freq = "BD (Every 12 hours)";
                    duration = "5 - 10 days";
                    remarks = "Or Pen V 500mg QID. Alternative: Amoxicillin 1g BD.";
                    break;
                case 'otitis':
                    drug = "Amoxicillin";
                    dose = "500 mg";
                    freq = "TDS (Every 8 hours)";
                    duration = "5 - 7 days";
                    remarks = "Treat as Rhinosinusitis dosing for adults.";
                    break;
                case 'rhinosinusitis':
                    drug = "Amoxicillin";
                    dose = "500 mg";
                    freq = "TDS (Every 8 hours)";
                    duration = "5 - 7 days";
                    remarks = "High dose (1g BD) can be considered if severe.";
                    break;
                case 'uti':
                    drug = "Nitrofurantoin (MR)";
                    dose = "100 mg";
                    freq = "BD (Every 12 hours)";
                    duration = "5 days";
                    remarks = "Preferred. Alternative: Cephalexin 500mg BD for 5 days.";
                    break;
                case 'skin':
                    drug = "Cloxacillin";
                    dose = "500 mg";
                    freq = "QID (Every 6 hours)";
                    duration = "5 - 7 days";
                    remarks = "Take on empty stomach (1h before/2h after food).";
                    break;
            }
        } 
        // PAEDS LOGIC
        else {
            switch (indication) {
                case 'pneumonia':
                    drug = "Amoxicillin (High Dose)";
                    // 90mg/kg/day divided by 2
                    let doseVal = (90 * weight) / 2;
                    if (doseVal > 2000) doseVal = 2000; // Max 2g per dose (4g daily)
                    dose = Math.round(doseVal) + " mg";
                    freq = "BD (Every 12 hours)";
                    duration = "5 - 7 days";
                    remarks = "Dose based on 90mg/kg/day. Effective for resistant Pneumococcal.";
                    break;
                case 'pharyngitis':
                    drug = "Amoxicillin";
                    // 50mg/kg/day divided by 2
                    let dosePhar = (50 * weight) / 2;
                    if (dosePhar > 1000) dosePhar = 1000; // Max 1g per dose
                    dose = Math.round(dosePhar) + " mg";
                    freq = "BD (Every 12 hours)";
                    duration = "10 days";
                    remarks = "Standard dose. Guideline also suggests Penicillin V 25-50mg/kg/day QID.";
                    break;
                case 'otitis':
                    drug = "Amoxicillin (High Dose)";
                    // 80-90mg/kg/day divided by 2
                    let doseAOM = (90 * weight) / 2;
                    if (doseAOM > 1500) doseAOM = 1500; // Max 3g/day approx
                    dose = Math.round(doseAOM) + " mg";
                    freq = "BD (Every 12 hours)";
                    duration = "5 - 7 days";
                    remarks = "High dose to cover resistant S. pneumoniae. If recent antibiotic use, consider Augmentin.";
                    break;
                case 'rhinosinusitis':
                    drug = "Amoxicillin";
                    // 90mg/kg/day divided by 2
                    let doseRhino = (90 * weight) / 2;
                    if (doseRhino > 1000) doseRhino = 1000; // Max 2g/day
                    dose = Math.round(doseRhino) + " mg";
                    freq = "BD (Every 12 hours)";
                    duration = "5 days";
                    remarks = "High dose recommended by NAG for Paeds Rhinosinusitis.";
                    break;
                case 'uti':
                    drug = "Cefuroxime Axetil";
                    // 30mg/kg/day divided by 2
                    let doseUti = (30 * weight) / 2;
                    if (doseUti > 250) doseUti = 250; // Guideline mentions max 500mg/day total for this indication
                    dose = Math.round(doseUti) + " mg";
                    freq = "BD (Every 12 hours)";
                    duration = "3 - 5 days";
                    remarks = "Preferred for Lower UTI > 3 months. Tablet can be crushed if syrup unavailable.";
                    break;
                case 'skin':
                    drug = "Cloxacillin";
                    // 50-100mg/kg/day divided by 4. Let's use 50mg/kg for mild.
                    let doseSkin = (50 * weight) / 4;
                    if (doseSkin > 500) doseSkin = 500; // Max adult dose 500mg
                    dose = Math.round(doseSkin) + " mg";
                    freq = "QID (Every 6 hours)";
                    duration = "5 - 7 days";
                    remarks = "Syrup usually 125mg/5ml. Take on empty stomach.";
                    break;
            }
        }

        // UPDATE UI
        document.getElementById('res-drug').innerText = drug;
        document.getElementById('res-dose').innerText = dose;
        document.getElementById('res-freq').innerText = freq;
        document.getElementById('res-duration').innerText = duration;
        document.getElementById('res-remarks').innerText = remarks;
        
        document.getElementById('result').style.display = 'block';
    }
</script>

</body>
</html>