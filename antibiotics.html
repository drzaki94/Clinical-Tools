<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KKM Antibiotic Dosing Guide (NAG Malaysia)</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: #f0f4f8;
            margin: 0;
            padding: 20px;
            color: #333;
        }
        .container {
            max-width: 600px;
            margin: 0 auto;
            background: #fff;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        h1 {
            text-align: center;
            color: #2c3e50;
            font-size: 22px;
            margin-bottom: 20px;
        }
        .disclaimer {
            font-size: 12px;
            color: #7f8c8d;
            background: #eef2f3;
            padding: 10px;
            border-radius: 6px;
            margin-bottom: 20px;
            text-align: center;
        }
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #34495e;
        }
        select, input {
            width: 100%;
            padding: 12px;
            margin-bottom: 20px;
            border: 1px solid #bdc3c7;
            border-radius: 8px;
            box-sizing: border-box;
            font-size: 16px;
        }
        button {
            width: 100%;
            padding: 15px;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: background 0.3s;
        }
        button:hover {
            background-color: #2980b9;
        }
        /* Error Message Style */
        #error-message {
            display: none;
            background-color: #fee2e2;
            color: #b91c1c;
            padding: 10px;
            border-radius: 6px;
            margin-bottom: 20px;
            text-align: center;
            font-size: 14px;
            border: 1px solid #fca5a5;
        }
        
        /* New Result Styles */
        #result-container {
            margin-top: 25px;
            display: none;
        }
        .option-card {
            background: #fff;
            border: 1px solid #d5dbdb;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            border-left: 5px solid #bdc3c7;
        }
        .option-card.preferred {
            border-left-color: #27ae60;
            background-color: #f0fdf4;
        }
        .option-card.alternative {
            border-left-color: #f39c12;
            background-color: #fef9e7;
        }
        .option-card.comorbid {
            border-left-color: #8e44ad;
            background-color: #f3e5f5;
        }
        .option-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        .badge {
            font-size: 11px;
            text-transform: uppercase;
            padding: 4px 8px;
            border-radius: 4px;
            font-weight: bold;
            letter-spacing: 0.5px;
        }
        .badge.preferred { background-color: #dcfce7; color: #166534; }
        .badge.alternative { background-color: #fef3c7; color: #92400e; }
        .badge.comorbid { background-color: #f3e8ff; color: #6b21a8; }

        .drug-name {
            font-size: 18px;
            font-weight: bold;
            color: #2c3e50;
            display: block;
        }
        .detail-row {
            display: flex;
            margin-bottom: 6px;
        }
        .detail-label {
            min-width: 80px;
            font-size: 13px;
            color: #7f8c8d;
            font-weight: 600;
        }
        .detail-val {
            font-size: 14px;
            color: #333;
        }
        .remarks {
            margin-top: 8px;
            font-size: 13px;
            color: #555;
            font-style: italic;
            border-top: 1px solid rgba(0,0,0,0.05);
            padding-top: 8px;
        }

        .hidden {
            display: none;
        }
        .source-link {
            text-align: center;
            margin-top: 20px;
            font-size: 12px;
        }
        .source-link a {
            color: #3498db;
            text-decoration: none;
        }
    </style>
</head>
<body>

<div class="container">
    <h1>ðŸ‡²ðŸ‡¾ KKM Antibiotic Dosing Guide</h1>
    <div class="disclaimer">
        Based on National Antimicrobial Guideline (NAG) 2019/2024/2025. <br>For healthcare professional use only. Verify with clinical judgment.
    </div>

    <!-- Error Message Container -->
    <div id="error-message"></div>

    <label for="category">Patient Category</label>
    <select id="category" onchange="toggleWeight()">
        <option value="adult">Adult</option>
        <option value="paeds">Paediatrics (Child)</option>
    </select>

    <div id="weight-container" class="hidden">
        <label for="weight">Weight (kg)</label>
        <input type="number" id="weight" placeholder="e.g. 15" step="0.1">
    </div>

    <label for="indication">Indication</label>
    <select id="indication">
        <option value="pneumonia">Community Acquired Pneumonia (CAP)</option>
        <option value="pharyngitis">Acute Pharyngitis / Tonsillitis</option>
        <option value="otitis">Acute Otitis Media</option>
        <option value="rhinosinusitis">Acute Rhinosinusitis</option>
        <option value="uti">Urinary Tract Infection (Uncomplicated)</option>
        <option value="impetigo">Skin - Impetigo</option>
        <option value="cellulitis">Skin - Cellulitis</option>
    </select>

    <button onclick="calculateDose()">Calculate Dose</button>

    <div id="result-container">
        <!-- Results will be injected here -->
    </div>

    <div class="source-link">
        Source: <a href="https://sites.google.com/moh.gov.my/nag" target="_blank">MOH NAG Website</a>
    </div>
</div>

<script>
    function toggleWeight() {
        const cat = document.getElementById('category').value;
        const weightDiv = document.getElementById('weight-container');
        if (cat === 'paeds') {
            weightDiv.classList.remove('hidden');
        } else {
            weightDiv.classList.add('hidden');
        }
        // Hide error and results when category changes to reset view
        hideError();
        document.getElementById('result-container').style.display = 'none';
    }

    function showError(msg) {
        const errDiv = document.getElementById('error-message');
        errDiv.innerText = msg;
        errDiv.style.display = 'block';
    }

    function hideError() {
        document.getElementById('error-message').style.display = 'none';
    }

    function renderOption(opt) {
        let typeClass = 'preferred';
        if (opt.type.toLowerCase().includes('alternative')) typeClass = 'alternative';
        if (opt.type.toLowerCase().includes('comorbid')) typeClass = 'comorbid';
        if (opt.type.toLowerCase().includes('severe')) typeClass = 'comorbid'; // Re-use purplish style for severe

        return `
        <div class="option-card ${typeClass}">
            <div class="option-header">
                <span class="badge ${typeClass}">${opt.type}</span>
            </div>
            <div class="drug-name">${opt.drug}</div>
            <div style="height: 10px;"></div>
            <div class="detail-row">
                <span class="detail-label">Dose:</span>
                <span class="detail-val">${opt.dose}</span>
            </div>
            <div class="detail-row">
                <span class="detail-label">Frequency:</span>
                <span class="detail-val">${opt.freq}</span>
            </div>
            <div class="detail-row">
                <span class="detail-label">Duration:</span>
                <span class="detail-val">${opt.duration}</span>
            </div>
            ${opt.remarks ? `<div class="remarks">${opt.remarks}</div>` : ''}
        </div>
        `;
    }

    function calculateDose() {
        hideError();
        const cat = document.getElementById('category').value;
        const weightInput = document.getElementById('weight').value;
        const weight = parseFloat(weightInput);
        const indication = document.getElementById('indication').value;
        const resultContainer = document.getElementById('result-container');
        
        let options = [];

        // ERROR HANDLING
        if (cat === 'paeds') {
            if (!weightInput || isNaN(weight) || weight <= 0) {
                showError("Please enter a valid weight in kg.");
                return;
            }
        }

        // ADULT LOGIC
        if (cat === 'adult') {
            switch (indication) {
                case 'pneumonia':
                    // Source: Acute bronchitis and pneumonia 10.09.2025.pdf
                    options.push({
                        type: "Preferred",
                        drug: "Amoxicillin",
                        dose: "500 mg - 1 g",
                        freq: "TDS (Every 8 hours)",
                        duration: "5 - 7 days",
                        remarks: "Preferred for patients without comorbidities."
                    });
                    options.push({
                        type: "Alternative",
                        drug: "Doxycycline",
                        dose: "100 mg",
                        freq: "BD (Every 12 hours)",
                        duration: "5 - 7 days",
                        remarks: ""
                    });
                    options.push({
                        type: "With Comorbidities",
                        drug: "Amoxicillin / Clavulanate (Augmentin)",
                        dose: "625 mg",
                        freq: "TDS (Every 8 hours)",
                        duration: "5 - 7 days",
                        remarks: "Preferred if patient has comorbidities (Heart/Lung/Liver/Renal/DM)."
                    });
                    break;

                case 'pharyngitis':
                    // Source: Acute pharyngitis 21.08.2024.pdf
                    options.push({
                        type: "Preferred",
                        drug: "Phenoxymethylpenicillin (Pen V)",
                        dose: "1 g (or 500mg QID)",
                        freq: "BD (Every 12 hours)",
                        duration: "5 - 10 days",
                        remarks: "Alternative: 500mg QID (Every 6 hours)."
                    });
                    options.push({
                        type: "Preferred",
                        drug: "Amoxicillin",
                        dose: "500 mg",
                        freq: "TDS (Every 8 hours)",
                        duration: "5 - 10 days",
                        remarks: ""
                    });
                    options.push({
                        type: "Alternative",
                        drug: "Erythromycin Ethylsuccinate",
                        dose: "800 mg",
                        freq: "BD (Every 12 hours)",
                        duration: "5 - 10 days",
                        remarks: "Suitable for Penicillin allergy."
                    });
                    break;

                case 'otitis':
                     // Source: Acute otitis media 21.08.2024.pdf
                    options.push({
                        type: "Preferred",
                        drug: "Amoxicillin",
                        dose: "500 mg",
                        freq: "TDS (Every 8 hours)",
                        duration: "5 - 7 days",
                        remarks: ""
                    });
                    options.push({
                        type: "Alternative",
                        drug: "Amoxicillin / Clavulanate",
                        dose: "625 mg",
                        freq: "TDS (Every 8 hours)",
                        duration: "5 - 7 days",
                        remarks: ""
                    });
                    options.push({
                        type: "Alternative",
                        drug: "Erythromycin Ethylsuccinate",
                        dose: "800 mg (BD) or 400mg (QID)",
                        freq: "BD or QID",
                        duration: "5 - 7 days",
                        remarks: "800mg q12h OR 400mg q6h."
                    });
                    break;

                case 'rhinosinusitis':
                    // Source: Acute rhinosinusitis 10.09.2025.pdf
                    options.push({
                        type: "Preferred",
                        drug: "Amoxicillin",
                        dose: "500 mg - 1 g",
                        freq: "TDS (Every 8 hours)",
                        duration: "5 days",
                        remarks: ""
                    });
                     options.push({
                        type: "Preferred",
                        drug: "Amoxicillin / Clavulanate",
                        dose: "625 mg",
                        freq: "TDS (Every 8 hours)",
                        duration: "5 days",
                        remarks: ""
                    });
                    options.push({
                        type: "Alternative",
                        drug: "Doxycycline",
                        dose: "100 mg",
                        freq: "BD (Every 12 hours)",
                        duration: "5 - 7 days",
                        remarks: ""
                    });
                    break;

                case 'uti':
                    // Source: UTI in non pregnancy 15.08.2024.pdf
                    options.push({
                        type: "Preferred",
                        drug: "Nitrofurantoin (MR or IR)",
                        dose: "100 mg (MR) or 50-100mg (IR)",
                        freq: "BD (MR) or QID (IR)",
                        duration: "5 days",
                        remarks: "Contraindicated if eGFR < 30 ml/min."
                    });
                    options.push({
                        type: "Preferred",
                        drug: "Cephalexin",
                        dose: "500 mg",
                        freq: "BD - QID (q6-12h)",
                        duration: "5 days",
                        remarks: "Consider QID if risk of complicated UTI."
                    });
                    options.push({
                        type: "Alternative",
                        drug: "Amoxicillin / Clavulanate",
                        dose: "625 mg",
                        freq: "TDS (Every 8 hours)",
                        duration: "3 - 5 days",
                        remarks: ""
                    });
                    options.push({
                        type: "Alternative",
                        drug: "Cefuroxime",
                        dose: "500 mg",
                        freq: "BD (Every 12 hours)",
                        duration: "3 - 5 days",
                        remarks: ""
                    });
                    break;

                case 'impetigo':
                case 'cellulitis':
                    // Mapping old adult skin logic to both new categories
                    // Source: SSTI 07.01.2025.pdf
                    options.push({
                        type: "Preferred",
                        drug: "Cephalexin",
                        dose: "1 g (1000 mg)",
                        freq: "BD (Every 12 hours)",
                        duration: "5 - 7 days",
                        remarks: "Up to 10 days for Cellulitis."
                    });
                    options.push({
                        type: "Preferred",
                        drug: "Cloxacillin",
                        dose: "500 mg",
                        freq: "QID (Every 6 hours)",
                        duration: "5 - 7 days",
                        remarks: "Take on empty stomach."
                    });
                    options.push({
                        type: "Preferred",
                        drug: "Amoxicillin",
                        dose: "500 mg",
                        freq: "TDS (Every 8 hours)",
                        duration: "5 - 10 days",
                        remarks: "Indicated for Cellulitis."
                    });
                    options.push({
                        type: "Alternative",
                        drug: "Amoxicillin / Clavulanate",
                        dose: "625 mg",
                        freq: "TDS (Every 8 hours)",
                        duration: "5 - 7 days",
                        remarks: ""
                    });
                    break;
            }
        } 
        // PAEDS LOGIC
        else {
            let handled = false;
            let singleOpt = { type: "Preferred", drug: "", dose: "", freq: "", duration: "", remarks: "" };
            
            switch (indication) {
                case 'pneumonia':
                    handled = true;
                    // PREFERRED: Amoxicillin High Dose
                    let amoxDose = "";
                    let amoxFreq = "";
                    
                    if (weight >= 3 && weight < 6) {
                        amoxDose = "250 mg"; amoxFreq = "BD (Every 12 hours)";
                    } else if (weight >= 6 && weight < 10) {
                        amoxDose = "375 mg"; amoxFreq = "BD (Every 12 hours)";
                    } else if (weight >= 10 && weight < 15) {
                        amoxDose = "500 mg"; amoxFreq = "BD (Every 12 hours)";
                    } else if (weight >= 15 && weight < 20) {
                        amoxDose = "750 mg"; amoxFreq = "BD (Every 12 hours)";
                    } else if (weight >= 20) {
                        amoxDose = "500 mg (TDS) or 1 g (BD)"; amoxFreq = "TDS or BD";
                    } else {
                        let val = (90 * weight) / 2;
                        amoxDose = Math.round(val) + " mg";
                        amoxFreq = "BD (Every 12 hours)";
                    }

                    options.push({
                        type: "Preferred",
                        drug: "Amoxicillin (High Dose)",
                        dose: amoxDose,
                        freq: amoxFreq,
                        duration: "5 - 7 days",
                        remarks: "High dose amoxicillin (80-90mg/kg/day). Max 4000mg/day."
                    });

                    let eryVal = (40 * weight) / 2;
                    if (eryVal > 1000) eryVal = 1000;
                    
                    options.push({
                        type: "Alternative",
                        drug: "Erythromycin Ethylsuccinate",
                        dose: Math.round(eryVal) + " mg",
                        freq: "BD (Every 12 hours)",
                        duration: "5 - 7 days",
                        remarks: "30-50mg/kg/day. Max 2g/day."
                    });
                    break;

                case 'pharyngitis':
                    handled = true;
                    let penVDose = (50 * weight) / 4;
                    if (penVDose > 500) penVDose = 500;
                    
                    options.push({
                        type: "Preferred",
                        drug: "Phenoxymethylpenicillin (Pen V)",
                        dose: Math.round(penVDose) + " mg",
                        freq: "QID (Every 6 hours)",
                        duration: "10 days",
                        remarks: "25-50mg/kg/day. Max 2g/day."
                    });

                    let amoxPharDose = (50 * weight) / 2;
                    if (amoxPharDose > 500) amoxPharDose = 500; 

                    options.push({
                        type: "Preferred",
                        drug: "Amoxicillin",
                        dose: Math.round(amoxPharDose) + " mg",
                        freq: "BD (Every 12 hours)",
                        duration: "10 days",
                        remarks: "50mg/kg/day. Max 1g/day. Can be given OD (double the dose)."
                    });

                    let cephDose = (50 * weight) / 2;
                    if (cephDose > 1000) cephDose = 1000; 
                    
                    options.push({
                        type: "Alternative (Allergy)",
                        drug: "Cephalexin",
                        dose: Math.round(cephDose) + " mg",
                        freq: "BD (Every 12 hours)",
                        duration: "10 days",
                        remarks: "25-50mg/kg/day. Max 2g/day."
                    });

                    let eryPharDose = (50 * weight) / 2;
                    if (eryPharDose > 2000) eryPharDose = 2000; 
                    
                    options.push({
                        type: "Alternative (Allergy)",
                        drug: "Erythromycin Ethylsuccinate",
                        dose: Math.round(eryPharDose) + " mg",
                        freq: "BD (Every 12 hours)",
                        duration: "10 days",
                        remarks: "40-50mg/kg/day. Max 4g/day."
                    });
                    break;

                case 'otitis':
                    handled = true;
                    let aomAmox = (90 * weight) / 2;
                    if (aomAmox > 1500) aomAmox = 1500; 
                    
                    options.push({
                        type: "Preferred",
                        drug: "Amoxicillin",
                        dose: Math.round(aomAmox) + " mg",
                        freq: "BD (Every 12 hours)",
                        duration: "5 - 7 days",
                        remarks: "80-90mg/kg/day. Max 3g/day."
                    });

                    let aomCef = (30 * weight) / 2;
                    if (aomCef > 500) aomCef = 500; 
                    
                    options.push({
                        type: "Alternative (Non-severe Allergy)",
                        drug: "Cefuroxime Axetil",
                        dose: Math.round(aomCef) + " mg",
                        freq: "BD (Every 12 hours)",
                        duration: "5 - 7 days",
                        remarks: "30mg/kg/day. Max 1g/day."
                    });

                    let aomEry = (50 * weight) / 2;
                    if (aomEry > 2000) aomEry = 2000;
                    
                    options.push({
                        type: "Alternative (Severe Allergy)",
                        drug: "Erythromycin Ethylsuccinate",
                        dose: Math.round(aomEry) + " mg",
                        freq: "BD (Every 12 hours)",
                        duration: "5 - 7 days",
                        remarks: "30-50mg/kg/day. Max 4g/day."
                    });

                    let azithDay1 = 10 * weight;
                    if (azithDay1 > 500) azithDay1 = 500;
                    let azithDay2 = 5 * weight;
                    if (azithDay2 > 250) azithDay2 = 250;

                    options.push({
                        type: "Alternative",
                        drug: "Azithromycin",
                        dose: `Day 1: ${Math.round(azithDay1)} mg<br>Day 2-5: ${Math.round(azithDay2)} mg`,
                        freq: "OD (Every 24 hours)",
                        duration: "5 days",
                        remarks: "10mg/kg on Day 1, then 5mg/kg daily."
                    });
                    break;

                case 'rhinosinusitis':
                    handled = true;
                    let rhinoAmox = (90 * weight) / 2;
                    if (rhinoAmox > 1000) rhinoAmox = 1000; 
                    
                    options.push({
                        type: "Preferred",
                        drug: "Amoxicillin",
                        dose: Math.round(rhinoAmox) + " mg",
                        freq: "BD (Every 12 hours)",
                        duration: "5 days",
                        remarks: "80-90mg/kg/day. Max 2g/day."
                    });

                    let rhinoCef = (30 * weight) / 2;
                    if (rhinoCef > 500) rhinoCef = 500; 

                    options.push({
                        type: "Alternative (Non-severe Allergy)",
                        drug: "Cefuroxime Axetil",
                        dose: Math.round(rhinoCef) + " mg",
                        freq: "BD (Every 12 hours)",
                        duration: "5 days",
                        remarks: "30mg/kg/day. Max 1g/day."
                    });

                    let rhinoEry = (50 * weight) / 2;
                    if (rhinoEry > 2000) rhinoEry = 2000; 

                    options.push({
                        type: "Alternative (Severe Allergy)",
                        drug: "Erythromycin Ethylsuccinate",
                        dose: Math.round(rhinoEry) + " mg",
                        freq: "BD (Every 12 hours)",
                        duration: "5 days",
                        remarks: "40-50mg/kg/day. Max 4g/day."
                    });
                    break;

                case 'uti':
                    handled = true;
                    let aug14 = (90 * weight) / 2;
                    if (aug14 > 1000) aug14 = 1000; 
                    
                    options.push({
                        type: "Preferred",
                        drug: "Amoxicillin / Clavulanate (Suspension 14:1)",
                        dose: Math.round(aug14) + " mg",
                        freq: "BD (Every 12 hours)",
                        duration: "3 - 5 days",
                        remarks: "Based on Amoxicillin component: 80-90mg/kg/day."
                    });

                    let aug7 = (45 * weight) / 2;
                    if (aug7 > 1000) aug7 = 1000;

                    options.push({
                        type: "Preferred",
                        drug: "Amoxicillin / Clavulanate (Suspension 7:1)",
                        dose: Math.round(aug7) + " mg",
                        freq: "BD (Every 12 hours)",
                        duration: "3 - 5 days",
                        remarks: "40-45mg/kg/day."
                    });

                    let utiCef = (30 * weight) / 2;
                    if (utiCef > 250) utiCef = 250; 
                    
                    options.push({
                        type: "Alternative",
                        drug: "Cefuroxime Axetil",
                        dose: Math.round(utiCef) + " mg",
                        freq: "BD (Every 12 hours)",
                        duration: "3 - 5 days",
                        remarks: "30mg/kg/day. Max 500mg/day."
                    });

                    let utiTmp = (10 * weight) / 2;
                    if (utiTmp > 160) utiTmp = 160;

                    options.push({
                        type: "Alternative",
                        drug: "Trimethoprim / Sulfamethoxazole",
                        dose: Math.round(utiTmp) + " mg (TMP component)",
                        freq: "BD (Every 12 hours)",
                        duration: "3 - 5 days",
                        remarks: "8-10mg/kg/day (based on Trimethoprim)."
                    });
                    break;

                case 'impetigo':
                    handled = true;
                    // PREFERRED (Localised)
                    options.push({
                        type: "Preferred (Localised)",
                        drug: "Topical 2% Fusidic Acid",
                        dose: "Apply thin layer",
                        freq: "2-3 times daily",
                        duration: "7 days",
                        remarks: "Outpatient management."
                    });

                    // PREFERRED (Generalised) - Cloxacillin
                    // 50-100mg/kg/day in 4 divided doses. Max 1g/day.
                    // Calculation based on higher end (100mg/kg) to ensure efficacy, capped at 1g
                    let impClox = (100 * weight) / 4;
                    if (impClox > 250) impClox = 250; // Max 1g/day = 250mg QID
                    
                    options.push({
                        type: "Preferred (Generalised)",
                        drug: "Cloxacillin",
                        dose: Math.round(impClox) + " mg",
                        freq: "QID (Every 6 hours)",
                        duration: "5 - 7 days",
                        remarks: "50-100mg/kg/day. Max 1g/day."
                    });

                    // ALTERNATIVE (Localised)
                    options.push({
                        type: "Alternative (Localised)",
                        drug: "Topical 2% Mupirocin Cream",
                        dose: "Apply thin layer",
                        freq: "2-3 times daily",
                        duration: "7 days",
                        remarks: ""
                    });

                    // ALTERNATIVE (Generalised) - Cephalexin
                    // 25-50mg/kg/day in 2 divided doses. Max 2g/day.
                    // Calculation based on 50mg/kg
                    let impCeph = (50 * weight) / 2;
                    if (impCeph > 1000) impCeph = 1000; // Max 2g/day = 1000mg BD

                    options.push({
                        type: "Alternative (Generalised)",
                        drug: "Cephalexin",
                        dose: Math.round(impCeph) + " mg",
                        freq: "BD (Every 12 hours)",
                        duration: "5 - 7 days",
                        remarks: "25-50mg/kg/day. Max 2g/day."
                    });
                    break;

                case 'cellulitis':
                    handled = true;
                    // PREFERRED (Mild) - Cloxacillin PO
                    // 50-100mg/kg/day in 4 divided doses. Max 1g/day.
                    let cellClox = (100 * weight) / 4;
                    if (cellClox > 250) cellClox = 250; // Max 1g/day = 250mg QID

                    options.push({
                        type: "Preferred (Mild)",
                        drug: "Cloxacillin",
                        dose: Math.round(cellClox) + " mg",
                        freq: "QID (Every 6 hours)",
                        duration: "5 - 7 days",
                        remarks: "50-100mg/kg/day. Max 1g/day."
                    });

                    // PREFERRED (Severe) - Cloxacillin IV
                    // 200mg/kg/day in 4 divided doses. Max 12g/day.
                    let cellCloxIV = (200 * weight) / 4;
                    if (cellCloxIV > 3000) cellCloxIV = 3000; // Max 12g/day = 3000mg QID

                    options.push({
                        type: "Preferred (Severe - IV)",
                        drug: "Cloxacillin (IV)",
                        dose: Math.round(cellCloxIV) + " mg",
                        freq: "QID (Every 6 hours)",
                        duration: "5 - 7 days",
                        remarks: "IV formulation. 200mg/kg/day. Max 12g/day."
                    });

                    // ALTERNATIVE - Cephalexin
                    // 25-50mg/kg/day in 2 divided doses. Max 2g/day.
                    let cellCeph = (50 * weight) / 2;
                    if (cellCeph > 1000) cellCeph = 1000; // Max 2g/day = 1000mg BD

                    options.push({
                        type: "Alternative",
                        drug: "Cephalexin",
                        dose: Math.round(cellCeph) + " mg",
                        freq: "BD (Every 12 hours)",
                        duration: "5 - 7 days",
                        remarks: "25-50mg/kg/day. Max 2g/day."
                    });
                    break;
            }
            if (!handled) {
                options.push(singleOpt);
            }
        }

        // UPDATE UI
        resultContainer.innerHTML = '';
        options.forEach(opt => {
            resultContainer.innerHTML += renderOption(opt);
        });
        
        resultContainer.style.display = 'block';
    }
</script>

</body>
</html>